<?xml version="1.0" encoding="utf-8"?>
<template>
	<name>viewList</name>
	<filePath>src/main/webapp/WEB-INF/views/${lastPackageName}/${moduleName}/${subModuleName}</filePath>
	<fileName>${className}List.jsp</fileName>
	<content><![CDATA[
<%@ page contentType="text/html;charset=UTF-8" %>
<%@ include file="/WEB-INF/views/include/taglib.jsp"%>
<html>
<head>
	<title>${functionNameSimple}管理</title>
	<meta name="decorator" content="default"/>
	<script type="text/javascript">
		$(document).ready(function() {
			
		});
		
		function page(n, s, p) {
			$("#" + p + "SearchForm").find("#pageNo").val(n);
			$("#" + p + "SearchForm").find("#pageSize").val(s);
			$("#" + p + "SearchForm").submit();
		}
		
		function submitForm(p){
			$("#" + p + "SearchForm").find("#pageNo").val("1");
			$("#" + p + "SearchForm").submit();
		}

		function moreOpera(item) {
			$(item).children("div").slideToggle();
		}
	</script>
</head>
<body>	
	<div class="main">
	
		<div class="main-box">
			<div class="main-box-title">
				<i class="glyphicon glyphicon-folder-open"></i><span> ${functionNameSimple}列表</span>
			</div>
			<form:form id="table01SearchForm" modelAttribute="${className}" action="${r"${ctx}"}/${urlPrefix}/listData" method="post" class="searchForm form-horizontal">
				<input id="pageNo" name="pageNo" type="hidden" value="${r"${page.pageNo}"}"/>
				<input id="pageSize" name="pageSize" type="hidden" value="${r"${page.pageSize}"}"/>	
				<input id="funcParam" name="funcParam" type="hidden" value="table01" />
							
				<#list table.columnList as c>
					<#if c.isQuery?? && c.isQuery == "1" && !(c.showType == "dateselect" && c.queryType == "between")>
					<div class="form-group col-md-4">
						<label for="${c.javaFieldId}" class="col-md-5 control-label">${c.comments}：</label>
						<div class="col-md-7">
							<#if c.showType == "input" || c.showType == "textarea">
								<form:input path="${c.javaFieldId}" htmlEscape="false"<#if c.dataLength != "0"> maxlength="${c.dataLength}"</#if> class="form-control"/>
							<#elseif c.showType == "select">
								<form:select path="${c.javaFieldId}" class="form-select">
									<form:option value="" label=""/>
									<form:options items="${"$"}{fns:getDictList('${c.dictType}')}" itemLabel="label" itemValue="value" htmlEscape="false"/>
								</form:select>
							<#elseif c.showType == "checkbox">
								<form:checkboxes path="${c.javaFieldId}" items="${"$"}{fns:getDictList('${c.dictType}')}" itemLabel="label" itemValue="value" htmlEscape="false" class="form-checkbox"/>
							<#elseif c.showType == "radiobox">
								<form:radiobuttons path="${c.javaFieldId}" items="${"$"}{fns:getDictList('${c.dictType}')}" itemLabel="label" itemValue="value" htmlEscape="false" class="form-checkbox"/>
							<#elseif c.showType == "dateselect">
								<input name="${c.javaFieldId}" type="text" readonly="readonly" maxlength="20" class="form-control Wdate"
									value="<fmt:formatDate value="${"$"}{${className}.${c.javaFieldId}}" pattern="yyyy-MM-dd HH:mm:ss"/>"
									onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',isShowClear:false,position:{left:235,top:108}});"/>
							<#elseif c.showType == "userselect">
								<sys:treeselect id="${c.simpleJavaField}" name="${c.javaFieldId}" value="${"$"}{${className}.${c.javaFieldId}}" labelName="" labelValue=""
									title="用户" url="/sys/office/treeData?type=3" cssClass="form-control" allowClear="true" notAllowSelectParent="true"/>
							<#elseif c.showType == "officeselect">
								<sys:treeselect id="${c.simpleJavaField}" name="${c.javaFieldId}" value="${"$"}{${className}.${c.javaFieldId}}" labelName="" labelValue=""
									title="部门" url="/sys/office/treeData?type=2" cssClass="input-small" allowClear="true" notAllowSelectParent="true"/>
							<#elseif c.showType == "areaselect">
								<sys:treeselect id="${c.simpleJavaField}" name="${c.javaFieldId}" value="${"$"}{${className}.${c.javaFieldId}}" labelName="" labelValue=""
									title="区域" url="/sys/area/treeData" cssClass="form-control" allowClear="true" notAllowSelectParent="true"/>
							</#if>
						</div>
						<div class="col-md-7 col-md-offset-4 errPlace"></div>
					</div>
					<#elseif c.showType == "dateselect" && c.queryType == "between">
					<div class="form-group col-md-8 form-date-range">
						<label for="${c.javaFieldId}" class="col-md-5 control-label">${c.comments}：</label>
						<div class="col-md-7">
							<input name="begin${c.simpleJavaField?cap_first}" type="text" readonly="readonly" maxlength="20" class="form-control Wdate"
								value="<fmt:formatDate value="${"$"}{${className}.begin${c.simpleJavaField?cap_first}}" pattern="yyyy-MM-dd HH:mm:ss"/>"
								onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',isShowClear:false,position:{left:235,top:108}});"/> - 
							<input name="end${c.simpleJavaField?cap_first}" type="text" readonly="readonly" maxlength="20" class="form-control Wdate"
								value="<fmt:formatDate value="${"$"}{${className}.end${c.simpleJavaField?cap_first}}" pattern="yyyy-MM-dd HH:mm:ss"/>"
								onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',isShowClear:false,position:{left:235,top:108}});"/>
						</div>
					</div>
					</#if>
				</#list>

			<#list table.genSpecialTablesList as gts>
				<#list gts.columnList as c>
					<#if c.isQuery?? && c.isQuery == "1" && !(c.showType == "dateselect" && c.queryType == "between")>
					<div class="form-group col-md-4">
						<label for="${c.javaFieldId}" class="col-md-5 control-label">${c.comments}：</label>
						<div class="col-md-7">
							<#if c.showType == "input" || c.showType == "textarea">
								<form:input path="${c.javaFieldId}" htmlEscape="false"<#if c.dataLength != "0"> maxlength="${c.dataLength}"</#if> class="form-control"/>
							<#elseif c.showType == "select">
								<form:select path="${c.javaFieldId}" class="form-select">
									<form:option value="" label=""/>
									<form:options items="${"$"}{fns:getDictList('${c.dictType}')}" itemLabel="label" itemValue="value" htmlEscape="false"/>
								</form:select>
							<#elseif c.showType == "checkbox">
								<form:checkboxes path="${c.javaFieldId}" items="${"$"}{fns:getDictList('${c.dictType}')}" itemLabel="label" itemValue="value" htmlEscape="false" class="form-checkbox"/>
							<#elseif c.showType == "radiobox">
								<form:radiobuttons path="${c.javaFieldId}" items="${"$"}{fns:getDictList('${c.dictType}')}" itemLabel="label" itemValue="value" htmlEscape="false" class="form-checkbox"/>
							<#elseif c.showType == "dateselect">
								<input name="${c.javaFieldId}" type="text" readonly="readonly" maxlength="20" class="form-control Wdate"
									value="<fmt:formatDate value="${"$"}{${className}.${c.javaFieldId}}" pattern="yyyy-MM-dd HH:mm:ss"/>"
									onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',isShowClear:false,position:{left:235,top:108}});"/>
							<#elseif c.showType == "userselect">
								<sys:treeselect id="${c.simpleJavaField}" name="${c.javaFieldId}" value="${"$"}{${className}.${c.javaFieldId}}" labelName="" labelValue=""
									title="用户" url="/sys/office/treeData?type=3" cssClass="form-control" allowClear="true" notAllowSelectParent="true"/>
							<#elseif c.showType == "officeselect">
								<sys:treeselect id="${c.simpleJavaField}" name="${c.javaFieldId}" value="${"$"}{${className}.${c.javaFieldId}}" labelName="" labelValue=""
									title="部门" url="/sys/office/treeData?type=2" cssClass="input-small" allowClear="true" notAllowSelectParent="true"/>
							<#elseif c.showType == "areaselect">
								<sys:treeselect id="${c.simpleJavaField}" name="${c.javaFieldId}" value="${"$"}{${className}.${c.javaFieldId}}" labelName="" labelValue=""
									title="区域" url="/sys/area/treeData" cssClass="form-control" allowClear="true" notAllowSelectParent="true"/>
							</#if>
						</div>
						<div class="col-md-7 col-md-offset-4 errPlace"></div>
					</div>
					<#elseif c.showType == "dateselect" && c.queryType == "between">
					<div class="form-group col-md-8 form-date-range">
						<label for="${c.javaFieldId}" class="col-md-5 control-label">${c.comments}：</label>
						<div class="col-md-7">
							<input name="begin${c.simpleJavaField?cap_first}" type="text" readonly="readonly" maxlength="20" class="form-control Wdate"
								value="<fmt:formatDate value="${"$"}{${className}.begin${c.simpleJavaField?cap_first}}" pattern="yyyy-MM-dd HH:mm:ss"/>"
								onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',isShowClear:false,position:{left:235,top:108}});"/> - 
							<input name="end${c.simpleJavaField?cap_first}" type="text" readonly="readonly" maxlength="20" class="form-control Wdate"
								value="<fmt:formatDate value="${"$"}{${className}.end${c.simpleJavaField?cap_first}}" pattern="yyyy-MM-dd HH:mm:ss"/>"
								onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',isShowClear:false,position:{left:235,top:108}});"/>
						</div>
					</div>
					</#if>
				  </#list>
				</#list>

					<div class="form-group col-md-4 col-md-offset-8 btn-group" style="min-height: 1px;">
						<div class="col-md-7 col-md-offset-5">
							<input id="btnSubmit" class="btn btn-blue f-right" type="button" value="查询" onclick="submitForm('table01');"/>
						</div>
					</div>
			</form:form>
		</div>
		<sys:message content="${r"${message}"}"/>
		<!-- Table -->
		<div class="main-box" style="padding-top: 10px;">
			<div class="col-xs-6 dataGridpageNumBox">
				<span>每页显示&ensp;</span>
				<select class="form-select" onchange="page('',this.value,'table01');">
					<option value="10">10</option>
					<option value="30" selected="selected">30</option>
					<option value="50">50</option>
					<option value="100">100</option>
				</select>
				<span>&ensp;条</span>
			</div>
			<div class="form-group col-xs-6" style="min-height: 45px;">
				<div class="col-md-12">					
					<a class="btn btn-blue f-right" href="${r"${ctx}"}/${urlPrefix}/form">添加</a>					
				</div>
			</div>
    		<table id="table01"></table>
			<!-- 页码 -->
			<div class="form-group col-md-8">
				<div class="pagination" id="table01Page"></div>
				<div class="tableDescribe" id="table01Describe"></div>
			</div>
		</div>
	</div>
	<link href="${r"${ctxStatic}"}/jqGrid/4.6/css/ui.jqgrid.css" type="text/css" rel="stylesheet" />
    <script src="${r"${ctxStatic}"}/jqGrid/4.7/js/jquery.jqGrid.js" type="text/javascript"></script>
    <script src="${r"${ctxStatic}"}/jqGrid/4.7/js/jquery.jqGrid.extend.js" type="text/javascript"></script>
    <script type="text/javascript">
        // 初始化DataGrid对象
        var tableName = "table01";
        $('#'+tableName).dataGrid(
            {
            	searchForm : $("#" + tableName +"SearchForm"),	
            	showCheckbox : false,//显示复选框
				showRownum : true,//显示行编号
				showDescribe : true,//显示第几页共几页
				gridComplete : function() {
							var ids = $("#"+tableName).getDataIDs();
							for (var i = 0; i < ids.length; i++) {
								var rowData = $("#"+tableName).getRowData(ids[i]);
								if (true) {
									//根据RowData.flag或其他属性值对行进行处理
									//$('#' + ids[i]).find("td").css("background-color","red");
								}
							}
						},
                columnModel : [ // 设置数据表格列
                        <#assign firstListField = true>
                        <#list table.columnList as c>
                            <#if c.isList?? && c.isList == "1">
                                {
                                     header : '${c.comments}',
                                     name : '${c.javaFieldId}',
                                     <#if firstListField>
                                          formatter : function(val, obj, row, act) {
                                            return '<a href="${r"${ctx}"}/${urlPrefix}/form?id=' + row.id + '" class="btnList" data-title="编辑">' + val + '</a>';
                                           },
                                     </#if>
                                     <#if c.simpleJavaType == "Date">
                                           formatter : function(val, obj, row, act) {
                                            return val;
                                           },
                                     </#if>
                                },
                                <#assign firstListField = false>                                
                            </#if>
                        </#list>

					<#list table.genSpecialTablesList as gts>
						<#list gts.columnList as c>
                            <#if c.isList?? && c.isList == "1">
                                {
                                     header : '${c.comments}',
                                     name : '${c.javaFieldId}',
                                     <#if firstListField>
                                          formatter : function(val, obj, row, act) {
                                            return '<a href="${r"${ctx}"}/${urlPrefix}/form?id=' + row.id + '" class="btnList" data-title="编辑">' + val + '</a>';
                                           },
                                     </#if>
                                     <#if c.simpleJavaType == "Date">
                                           formatter : function(val, obj, row, act) {
                                            return val;
                                           },
                                     </#if>
                                },
                                <#assign firstListField = false>                                
                            </#if>
                        </#list>
					</#list>
                            {
                                header : '操作',
                                name : 'actions',
                                sortable : false,
                                formatter : function(val, obj, row, act) {
                                    var actions = [];
                                    	actions.push('<a href="${r"${ctx}"}/${urlPrefix}/form?id=' + row.id + '" class="btnList" title="编辑">编辑</a>&nbsp;');
                                    	actions.push('<a href="${r"${ctx}"}/${urlPrefix}/delete?id='+ row.id + '" class="btnList" onclick="return confirmx(\'确认要删除该${functionNameSimple}吗？\', this.href)">删除</a>&nbsp;');
                                    	actions.push('<a href="${r"${ctx}"}/${urlPrefix}/show?id=' + row.id + '" class="btnList" title="查看">查看</a>&nbsp;');
                                    	// actions.push('<span title="更多" class="btnList more" onclick="moreOpera(this);">更多<div><a>其他方法1</a><a>其他方法2</a></div></span>');
                                    return actions.join('');
                                }
                            },
                   ],
                ajaxSuccess : function(data) { // 加载成功后执行方法

                }
            });
    </script>
</body>
</html>]]>
	</content>
</template>